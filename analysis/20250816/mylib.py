import pandas as pd
from scipy import stats
from os.path import join
from pathlib import Path
import pathlib
from typing import Dict, List

genomes = {
    "ACB": ['HG02323', 'HG02337', 'HG02555', 'HG02284', 'HG02053', 'HG02307', 'HG02052', 'HG01986', 'HG02549', 'HG02479', 'HG02554', 'HG02427', 'HG02471', 'HG01880', 'HG02419', 'HG02332', 'HG02108', 'HG01883', 'HG02537', 'HG02318', 'HG01985', 'HG02484', 'HG02497', 'HG02470', 'HG02334', 'HG02476', 'HG02545', 'HG02054', 'HG02330', 'HG01879', 'HG02501', 'HG02450', 'HG02317', 'HG02477', 'HG02489', 'HG01890', 'HG02502', 'HG02481', 'HG02449', 'HG02546', 'HG02439', 'HG01882', 'HG02558', 'HG02433', 'HG02496', 'HG02508', 'HG01896', 'HG01894', 'HG02445', 'HG02283', 'HG02255', 'HG02256', 'HG02580', 'HG02051', 'HG01889', 'HG02014', 'HG02511', 'HG01885', 'HG01988', 'HG01912', 'HG02420', 'HG02315', 'HG02111', 'HG01958', 'HG02095', 'HG01886', 'HG01990', 'HG02541', 'HG02314', 'HG01956', 'HG02442', 'HG02429', 'HG01914', 'HG02282', 'HG02325', 'HG02505', 'HG02010', 'HG02309', 'HG02322', 'HG02107', 'HG02144', 'HG02012', 'HG02308', 'HG02536', 'HG02436', 'HG02343', 'HG02009', 'HG01915', 'HG02485', 'HG02577', 'HG01989', 'HG02281', 'HG02455', 'HG02143', 'HG02557', 'HG02013', 'HG02339'],
    "ASW": ['NA20359', 'NA19713', 'NA20342', 'NA20289', 'NA19982', 'NA20281', 'NA19703', 'NA19711', 'NA20351', 'NA19712', 'NA20317', 'NA19818', 'NA19923', 'NA19921', 'NA20126', 'NA20357', 'NA20294', 'NA19819', 'NA20298', 'NA19917', 'NA20340', 'NA20314', 'NA19701', 'NA20346', 'NA19834', 'NA19908', 'NA20412', 'NA20282', 'NA19835', 'NA20356', 'NA20348', 'NA19707', 'NA19900', 'NA19984', 'NA20127', 'NA20339', 'NA19916', 'NA19904', 'NA19909', 'NA20287', 'NA20278', 'NA20332', 'NA20276', 'NA19920', 'NA19625', 'NA20334', 'NA20291', 'NA20299', 'NA19922', 'NA19901', 'NA20296', 'NA19914', 'NA19704', 'NA19700'],
    "BEB": ['HG03928', 'HG03805', 'HG03916', 'HG03814', 'HG04158', 'HG03931', 'HG03607', 'HG04153', 'HG03800', 'HG03910', 'HG03802', 'HG03589', 'HG03009', 'HG03595', 'HG04188', 'HG03941', 'HG03598', 'HG03907', 'HG04176', 'HG03919', 'HG04177', 'HG03826', 'HG03603', 'HG04171', 'HG03913', 'HG03817', 'HG04186', 'HG04155', 'HG03803', 'HG03812', 'HG04140', 'HG03600', 'HG03920', 'HG03917', 'HG03937', 'HG03911', 'HG04161', 'HG03925', 'HG03793', 'HG04173', 'HG04185', 'HG03611', 'HG03830', 'HG04144', 'HG03821', 'HG03908', 'HG03824', 'HG03012', 'HG03616', 'HG04156', 'HG03922', 'HG03914', 'HG03796', 'HG03594', 'HG03823', 'HG03809', 'HG04131', 'HG03006', 'HG03902', 'HG04152', 'HG04182', 'HG03604', 'HG04180', 'HG03940', 'HG03593', 'HG03585', 'HG03829', 'HG04159', 'HG04141', 'HG03832', 'HG03905', 'HG03833', 'HG04195', 'HG04189', 'HG03615', 'HG04164', 'HG04194', 'HG03815', 'HG04146', 'HG03934', 'HG03007', 'HG04183', 'HG03926', 'HG04162', 'HG04134', 'HG03808'],
    "CDX": ['HG00851', 'HG02389', 'HG02181', 'HG01813', 'HG02383', 'HG01794', 'HG02188', 'HG02152', 'HG02391', 'HG01801', 'HG02402', 'HG02355', 'HG02190', 'HG01817', 'HG02250', 'HG02178', 'HG01816', 'HG01808', 'HG02185', 'HG02375', 'HG02394', 'HG02182', 'HG02186', 'HG00766', 'HG02392', 'HG02360', 'HG02386', 'HG02166', 'HG02401', 'HG02356', 'HG02397', 'HG01807', 'HG01797', 'HG01029', 'HG01805', 'HG02164', 'HG01815', 'HG02156', 'HG02409', 'HG02179', 'HG02353', 'HG02390', 'HG02385', 'HG02382', 'HG02154', 'HG02379', 'HG02398', 'HG02187', 'HG02155', 'HG02380', 'HG00879', 'HG02184', 'HG00867', 'HG02407', 'HG01796', 'HG00982', 'HG01802', 'HG02151', 'HG02408', 'HG00864', 'HG02373', 'HG01806', 'HG02384', 'HG01795', 'HG00956', 'HG02371', 'HG00844', 'HG01800', 'HG02153', 'HG01811', 'HG01046', 'HG02364', 'HG02180', 'HG02406', 'HG02399', 'HG02351', 'HG02165', 'HG01812', 'HG02410', 'HG00978', 'HG02395', 'HG01809', 'HG01798', 'HG02396', 'HG01031', 'HG01799', 'HG01028', 'HG00881', 'HG01804', 'HG01810', 'HG02374', 'HG02367', 'HG00759'],
    "CHB": ['NA18605', 'NA18573', 'NA18627', 'NA18747', 'NA18616', 'NA18596', 'NA18552', 'NA18648', 'NA18626', 'NA18619', 'NA18612', 'NA18565', 'NA18530', 'NA18570', 'NA18740', 'NA18602', 'NA18611', 'NA18577', 'NA18609', 'NA18576', 'NA18597', 'NA18610', 'NA18582', 'NA18553', 'NA18608', 'NA18592', 'NA18635', 'NA18645', 'NA18533', 'NA18574', 'NA18539', 'NA18757', 'NA18636', 'NA18638', 'NA18615', 'NA18613', 'NA18625', 'NA18591', 'NA18527', 'NA18562', 'NA18531', 'NA18542', 'NA18559', 'NA18634', 'NA18632', 'NA18528', 'NA18564', 'NA18560', 'NA18642', 'NA18534', 'NA18547', 'NA18628', 'NA18639', 'NA18557', 'NA18545', 'NA18599', 'NA18561', 'NA18532', 'NA18641', 'NA18631', 'NA18536', 'NA18550', 'NA18748', 'NA18630', 'NA18617', 'NA18546', 'NA18629', 'NA18579', 'NA18538', 'NA18593', 'NA18526', 'NA18745', 'NA18541', 'NA18548', 'NA18620', 'NA18614', 'NA18621', 'NA18623', 'NA18571', 'NA18606', 'NA18525', 'NA18637', 'NA18572', 'NA18567', 'NA18549', 'NA18624', 'NA18563', 'NA18603', 'NA18622', 'NA18555', 'NA18749', 'NA18543', 'NA18544', 'NA18537', 'NA18640', 'NA18618', 'NA18595', 'NA18633', 'NA18643', 'NA18535', 'NA18558', 'NA18647'],
    "CHS": ['HG00613', 'HG00692', 'HG00479', 'HG00536', 'HG00583', 'HG00565', 'HG00566', 'HG00701', 'HG00500', 'HG00620', 'HG00525', 'HG00656', 'HG00443', 'HG00698', 'HG00473', 'HG00542', 'HG00593', 'HG00464', 'HG00653', 'HG00650', 'HG00632', 'HG00580', 'HG00607', 'HG00634', 'HG00543', 'HG00651', 'HG00704', 'HG00614', 'HG00683', 'HG00537', 'HG00599', 'HG00472', 'HG00531', 'HG00448', 'HG00452', 'HG00476', 'HG00623', 'HG00608', 'HG00421', 'HG00409', 'HG00729', 'HG00403', 'HG00404', 'HG00654', 'HG00684', 'HG00619', 'HG00581', 'HG00625', 'HG00584', 'HG00524', 'HG00428', 'HG00478', 'HG00560', 'HG00446', 'HG00626', 'HG00671', 'HG00610', 'HG00717', 'HG00662', 'HG00442', 'HG00693', 'HG00534', 'HG00410', 'HG00689', 'HG00707', 'HG00672', 'HG00592', 'HG00407', 'HG00699', 'HG00690', 'HG00419', 'HG00406', 'HG00705', 'HG00674', 'HG00533', 'HG00457', 'HG00657', 'HG00596', 'HG00463', 'HG00631', 'HG00628', 'HG00559', 'HG00513', 'HG00598', 'HG00556', 'HG00589', 'HG00629', 'HG00590', 'HG00557', 'HG00451', 'HG00595', 'HG00728', 'HG00445', 'HG00663', 'HG00675', 'HG00622', 'HG00475', 'HG00530', 'HG00422', 'HG00708', 'HG00458', 'HG00437', 'HG00449', 'HG00436', 'HG00611'],
    "CLM": ['HG01269', 'HG01498', 'HG01356', 'HG01125', 'HG01342', 'HG01375', 'HG01383', 'HG01479', 'HG01447', 'HG01121', 'HG01488', 'HG01468', 'HG01345', 'HG01550', 'HG01136', 'HG01112', 'HG01140', 'HG01369', 'HG01250', 'HG01431', 'HG01384', 'HG01280', 'HG01390', 'HG01485', 'HG01257', 'HG01491', 'HG01365', 'HG01357', 'HG01348', 'HG01142', 'HG01432', 'HG01456', 'HG01133', 'HG01148', 'HG01260', 'HG01360', 'HG01455', 'HG01139', 'HG01275', 'HG01130', 'HG01149', 'HG01556', 'HG01378', 'HG01465', 'HG01440', 'HG01489', 'HG01372', 'HG01443', 'HG01389', 'HG01486', 'HG01254', 'HG01497', 'HG01551', 'HG01122', 'HG01461', 'HG01359', 'HG01354', 'HG01363', 'HG01134', 'HG01350', 'HG01277', 'HG01494', 'HG01464', 'HG01351', 'HG01435', 'HG01131', 'HG01495', 'HG01259', 'HG01353', 'HG01284', 'HG01362', 'HG01377', 'HG01271', 'HG01366', 'HG01272', 'HG01119', 'HG01281', 'HG01251', 'HG01441', 'HG01438', 'HG01444', 'HG01256', 'HG01344', 'HG01253', 'HG01374', 'HG01459', 'HG01113', 'HG01474', 'HG01462', 'HG01341', 'HG01124', 'HG01437', 'HG01492', 'HG01137'],
    "ESN": ['HG03136', 'HG03193', 'HG03343', 'HG02973', 'HG03105', 'HG03132', 'HG02974', 'HG03279', 'HG03159', 'HG03198', 'HG02953', 'HG03117', 'HG03111', 'HG03518', 'HG03199', 'HG03124', 'HG02977', 'HG03352', 'HG02952', 'HG03354', 'HG02981', 'HG03139', 'HG03118', 'HG02923', 'HG03342', 'HG03108', 'HG03112', 'HG03311', 'HG03120', 'HG03126', 'HG03294', 'HG03517', 'HG03304', 'HG03301', 'HG02976', 'HG03351', 'HG03175', 'HG03265', 'HG03372', 'HG03295', 'HG03280', 'HG03168', 'HG03202', 'HG03499', 'HG03133', 'HG02970', 'HG03109', 'HG03115', 'HG03171', 'HG03366', 'HG03300', 'HG03369', 'HG03121', 'HG02979', 'HG03190', 'HG03514', 'HG03099', 'HG03189', 'HG02944', 'HG03303', 'HG03127', 'HG03271', 'HG03520', 'HG03103', 'HG03163', 'HG02922', 'HG03100', 'HG03195', 'HG03297', 'HG02968', 'HG03291', 'HG03114', 'HG02943', 'HG03268', 'HG03298', 'HG03160', 'HG03370', 'HG03166', 'HG03129', 'HG03363', 'HG03511', 'HG03267', 'HG03521', 'HG02946', 'HG02971', 'HG03515', 'HG03169', 'HG03162', 'HG03196', 'HG03172', 'HG03157', 'HG03123', 'HG03130', 'HG02947', 'HG02938', 'HG03135', 'HG03313', 'HG03270', 'HG03367', 'HG02941'],
    "FIN": ['HG00349', 'HG00327', 'HG00266', 'HG00323', 'HG00368', 'HG00326', 'HG00270', 'HG00321', 'HG00337', 'HG00189', 'HG00272', 'HG00382', 'HG00364', 'HG00304', 'HG00339', 'HG00330', 'HG00355', 'HG00186', 'HG00308', 'HG00353', 'HG00285', 'HG00273', 'HG00371', 'HG00274', 'HG00375', 'HG00282', 'HG00346', 'HG00345', 'HG00325', 'HG00367', 'HG00183', 'HG00366', 'HG00358', 'HG00275', 'HG00177', 'HG00178', 'HG00338', 'HG00319', 'HG00311', 'HG00381', 'HG00334', 'HG00277', 'HG00369', 'HG00324', 'HG00267', 'HG00372', 'HG00342', 'HG00284', 'HG00190', 'HG00181', 'HG00356', 'HG00180', 'HG00176', 'HG00271', 'HG00362', 'HG00288', 'HG00384', 'HG00182', 'HG00376', 'HG00336', 'HG00350', 'HG00318', 'HG00188', 'HG00344', 'HG00315', 'HG00269', 'HG00335', 'HG00179', 'HG00377', 'HG00185', 'HG00359', 'HG00383', 'HG00380', 'HG00276', 'HG00268', 'HG00332', 'HG00278', 'HG00365', 'HG00281', 'HG00343', 'HG00351', 'HG00187', 'HG00373', 'HG00320', 'HG00310', 'HG00171', 'HG00313', 'HG00357', 'HG00361', 'HG00379', 'HG00378', 'HG00309', 'HG00328', 'HG00290', 'HG00331', 'HG00329', 'HG00174', 'HG00312', 'HG00306', 'HG00341', 'HG00360', 'HG00280', 'HG00173'],
    "GBR": ['HG00231', 'HG00129', 'HG00251', 'HG00118', 'HG00134', 'HG00100', 'HG00097', 'HG00128', 'HG02215', 'HG00146', 'HG00249', 'HG00256', 'HG00103', 'HG00243', 'HG00157', 'HG01789', 'HG00120', 'HG00139', 'HG00109', 'HG00254', 'HG00250', 'HG00135', 'HG00236', 'HG00126', 'HG00148', 'HG00150', 'HG00160', 'HG00143', 'HG00108', 'HG00155', 'HG00232', 'HG00115', 'HG00142', 'HG00239', 'HG00233', 'HG00113', 'HG00260', 'HG00257', 'HG00158', 'HG00252', 'HG00253', 'HG00114', 'HG00238', 'HG00246', 'HG00117', 'HG00096', 'HG00104', 'HG00262', 'HG00119', 'HG00121', 'HG00133', 'HG00130', 'HG00259', 'HG00140', 'HG00141', 'HG00240', 'HG00123', 'HG00156', 'HG00255', 'HG00263', 'HG00105', 'HG00110', 'HG00235', 'HG01334', 'HG00107', 'HG00131', 'HG00138', 'HG00152', 'HG00245', 'HG00159', 'HG00099', 'HG00264', 'HG00137', 'HG00116', 'HG00122', 'HG00234', 'HG00125', 'HG00111', 'HG00261', 'HG01791', 'HG00101', 'HG00149', 'HG00136', 'HG00244', 'HG01790', 'HG00132', 'HG00102', 'HG00154', 'HG00258', 'HG00106', 'HG00112', 'HG00265', 'HG00151', 'HG00237', 'HG00127', 'HG00145'],
    "GIH": ['NA20877', 'NA21111', 'NA21141', 'NA21098', 'NA21130', 'NA20905', 'NA21102', 'NA20859', 'NA21133', 'NA21099', 'NA21089', 'NA21104', 'NA20882', 'NA20875', 'NA20847', 'NA21105', 'NA21107', 'NA21127', 'NA20867', 'NA20901', 'NA20868', 'NA20846', 'NA21115', 'NA20874', 'NA20902', 'NA20910', 'NA21110', 'NA21094', 'NA21097', 'NA21088', 'NA21095', 'NA21116', 'NA20896', 'NA21091', 'NA20861', 'NA21118', 'NA20858', 'NA20850', 'NA20903', 'NA21135', 'NA20872', 'NA21125', 'NA20900', 'NA21124', 'NA20892', 'NA20851', 'NA21103', 'NA20849', 'NA20911', 'NA20906', 'NA21142', 'NA20862', 'NA20866', 'NA20895', 'NA21086', 'NA20870', 'NA20894', 'NA20881', 'NA21128', 'NA20904', 'NA21143', 'NA21113', 'NA20891', 'NA21119', 'NA21092', 'NA20854', 'NA20869', 'NA21137', 'NA20890', 'NA20887', 'NA20864', 'NA20897', 'NA21109', 'NA21120', 'NA21129', 'NA21087', 'NA20873', 'NA20883', 'NA20889', 'NA20908', 'NA21117', 'NA21093', 'NA20853', 'NA21122', 'NA21090', 'NA21106', 'NA20899', 'NA21126', 'NA21123', 'NA20884', 'NA20876', 'NA21114', 'NA20888', 'NA21101', 'NA20852', 'NA20886', 'NA21100', 'NA20856', 'NA21108', 'NA20845', 'NA20863', 'NA20885', 'NA20878', 'NA21112', 'NA21144', 'NA21121'],
    "GWD": ['HG02839', 'HG02805', 'HG03259', 'HG02703', 'HG02613', 'HG03024', 'HG03039', 'HG02621', 'HG03538', 'HG02852', 'HG02643', 'HG02667', 'HG02461', 'HG02808', 'HG02465', 'HG02861', 'HG02676', 'HG02760', 'HG02771', 'HG02611', 'HG03045', 'HG03040', 'HG02715', 'HG02888', 'HG02982', 'HG02860', 'HG02589', 'HG02716', 'HG02594', 'HG02702', 'HG02679', 'HG02769', 'HG02890', 'HG02882', 'HG02895', 'HG03241', 'HG02851', 'HG02840', 'HG02623', 'HG02568', 'HG02620', 'HG02614', 'HG02583', 'HG03247', 'HG02635', 'HG02678', 'HG02817', 'HG02675', 'HG02807', 'HG03025', 'HG03258', 'HG02881', 'HG02595', 'HG02585', 'HG02722', 'HG02588', 'HG02887', 'HG02813', 'HG02561', 'HG02820', 'HG02816', 'HG02819', 'HG03028', 'HG02645', 'HG02642', 'HG02757', 'HG02721', 'HG02884', 'HG02646', 'HG02629', 'HG03539', 'HG02804', 'HG02885', 'HG03246', 'HG02763', 'HG02836', 'HG02879', 'HG03048', 'HG02810', 'HG02855', 'HG02574', 'HG02799', 'HG02854', 'HG02586', 'HG02573', 'HG02878', 'HG03027', 'HG02628', 'HG02666', 'HG02571', 'HG02570', 'HG03240', 'HG02891', 'HG02610', 'HG02811', 'HG02464', 'HG03049', 'HG02870', 'HG02798', 'HG02582', 'HG02624', 'HG02983', 'HG02562', 'HG03046', 'HG02759', 'HG02837', 'HG02634', 'HG02896', 'HG02462', 'HG02768', 'HG02814'],
    "IBS": ['HG01506', 'HG01507', 'HG01624', 'HG01684', 'HG01709', 'HG01603', 'HG01704', 'HG01518', 'HG01503', 'HG01779', 'HG01631', 'HG01707', 'HG01784', 'HG01672', 'HG01700', 'HG01699', 'HG01605', 'HG01504', 'HG01620', 'HG01608', 'HG01606', 'HG01612', 'HG01682', 'HG01675', 'HG01697', 'HG01509', 'HG01773', 'HG01670', 'HG01618', 'HG02235', 'HG01705', 'HG01615', 'HG01756', 'HG01536', 'HG01524', 'HG01766', 'HG01632', 'HG01708', 'HG01785', 'HG01519', 'HG01625', 'HG01619', 'HG01626', 'HG01630', 'HG01527', 'HG01768', 'HG01781', 'HG01686', 'HG01777', 'HG01513', 'HG01521', 'HG02238', 'HG02231', 'HG01516', 'HG01702', 'HG01761', 'HG01602', 'HG01786', 'HG01767', 'HG01525', 'HG01668', 'HG01500', 'HG01607', 'HG01512', 'HG01776', 'HG02220', 'HG01676', 'HG01694', 'HG01515', 'HG02221', 'HG01770', 'HG01757', 'HG02239', 'HG02236', 'HG02233', 'HG01747', 'HG01528', 'HG01679', 'HG01510', 'HG01673', 'HG01537', 'HG01610', 'HG01685', 'HG01678', 'HG01530', 'HG01710', 'HG02230', 'HG01628', 'HG01531', 'HG01617', 'HG01775', 'HG01746', 'HG01501', 'HG02224', 'HG01669', 'HG02232', 'HG01613', 'HG01771', 'HG01783', 'HG01680', 'HG01762', 'HG01765', 'HG02223', 'HG01623', 'HG01522', 'HG02219', 'HG01695'],
    "ITU": ['HG03727', 'HG03967', 'HG03869', 'HG03874', 'HG04098', 'HG04200', 'HG04211', 'HG04206', 'HG03965', 'HG03742', 'HG04214', 'HG03977', 'HG03775', 'HG04020', 'HG04017', 'HG04225', 'HG04062', 'HG03785', 'HG04023', 'HG04059', 'HG04014', 'HG04002', 'HG03782', 'HG04238', 'HG04212', 'HG04015', 'HG03866', 'HG03974', 'HG03968', 'HG03870', 'HG03789', 'HG03731', 'HG03864', 'HG03729', 'HG04061', 'HG04093', 'HG03969', 'HG03771', 'HG03717', 'HG04239', 'HG04022', 'HG03730', 'HG03960', 'HG04216', 'HG03971', 'HG03867', 'HG04096', 'HG03720', 'HG03777', 'HG04025', 'HG04094', 'HG03779', 'HG04063', 'HG03976', 'HG04060', 'HG04219', 'HG03861', 'HG04070', 'HG03770', 'HG03882', 'HG03784', 'HG03862', 'HG04090', 'HG03718', 'HG03714', 'HG03774', 'HG04056', 'HG04076', 'HG03780', 'HG03713', 'HG04054', 'HG04018', 'HG03772', 'HG04198', 'HG03787', 'HG04080', 'HG03781', 'HG03868', 'HG04209', 'HG03778', 'HG03871', 'HG03790', 'HG03872', 'HG04019', 'HG03716', 'HG04001', 'HG03786', 'HG03963', 'HG03863', 'HG04118', 'HG03773', 'HG03973', 'HG03792', 'HG03873', 'HG03875', 'HG04235', 'HG04202', 'HG04026', 'HG04222', 'HG03978', 'HG03788'],
    "JPT": ['NA18999', 'NA18960', 'NA18976', 'NA19081', 'NA18987', 'NA18985', 'NA19077', 'NA19006', 'NA18948', 'NA19009', 'NA18959', 'NA19060', 'NA19091', 'NA18965', 'NA19059', 'NA19003', 'NA19000', 'NA18941', 'NA19076', 'NA19080', 'NA18994', 'NA18973', 'NA18974', 'NA18961', 'NA19063', 'NA18979', 'NA18947', 'NA19087', 'NA18981', 'NA19064', 'NA18945', 'NA19082', 'NA19070', 'NA18972', 'NA18949', 'NA18975', 'NA18989', 'NA18967', 'NA19083', 'NA18997', 'NA18966', 'NA19090', 'NA18983', 'NA18952', 'NA19062', 'NA19012', 'NA18955', 'NA18940', 'NA19004', 'NA18970', 'NA18946', 'NA18971', 'NA18988', 'NA18977', 'NA18980', 'NA18939', 'NA19088', 'NA18957', 'NA19065', 'NA19078', 'NA19074', 'NA18968', 'NA18982', 'NA19011', 'NA18995', 'NA19054', 'NA18990', 'NA18978', 'NA18943', 'NA19066', 'NA18953', 'NA19056', 'NA18962', 'NA19072', 'NA19068', 'NA18964', 'NA19067', 'NA18951', 'NA18992', 'NA19057', 'NA18963', 'NA19089', 'NA18984', 'NA18956', 'NA19002', 'NA18993', 'NA19055', 'NA18969', 'NA19005', 'NA19007', 'NA19010', 'NA19079', 'NA18991', 'NA18986', 'NA18942', 'NA19058', 'NA18944', 'NA19084', 'NA19075', 'NA18950', 'NA19086', 'NA19085', 'NA19001', 'NA18954', 'NA18998'],
    "KHV": ['HG02069', 'HG01846', 'HG02078', 'HG01851', 'HG01865', 'HG01862', 'HG02137', 'HG02050', 'HG02019', 'HG02029', 'HG02522', 'HG01850', 'HG02072', 'HG02139', 'HG02058', 'HG02081', 'HG01858', 'HG01867', 'HG02032', 'HG02122', 'HG01860', 'HG02016', 'HG01869', 'HG02061', 'HG02084', 'HG01852', 'HG02026', 'HG02521', 'HG01848', 'HG02130', 'HG02140', 'HG02113', 'HG02075', 'HG01598', 'HG02047', 'HG02121', 'HG01599', 'HG02136', 'HG01863', 'HG01874', 'HG02138', 'HG02025', 'HG01844', 'HG01845', 'HG02049', 'HG01870', 'HG02133', 'HG02088', 'HG02028', 'HG02076', 'HG01842', 'HG02023', 'HG02142', 'HG02035', 'HG02085', 'HG02086', 'HG02513', 'HG01873', 'HG02134', 'HG01871', 'HG01600', 'HG01868', 'HG02060', 'HG01878', 'HG02020', 'HG02127', 'HG01864', 'HG01595', 'HG02048', 'HG01847', 'HG01859', 'HG01861', 'HG01849', 'HG01843', 'HG02031', 'HG02512', 'HG01857', 'HG01853', 'HG02082', 'HG02073', 'HG02128', 'HG01855', 'HG02064', 'HG02040', 'HG02087', 'HG01597', 'HG02079', 'HG01872', 'HG02070', 'HG02131', 'HG02017', 'HG01866', 'HG02116', 'HG01840', 'HG01841', 'HG01596', 'HG02141', 'HG02067', 'HG02057'],
    "LWK": ['NA19025', 'NA19474', 'NA19461', 'NA19472', 'NA19462', 'NA19475', 'NA19440', 'NA19017', 'NA19454', 'NA19375', 'NA19452', 'NA19431', 'NA19468', 'NA19327', 'NA19446', 'NA19319', 'NA19023', 'NA19307', 'NA19428', 'NA19397', 'NA19435', 'NA19434', 'NA19024', 'NA19044', 'NA19338', 'NA19324', 'NA19038', 'NA19377', 'NA19028', 'NA19449', 'NA19360', 'NA19351', 'NA19401', 'NA19399', 'NA19315', 'NA19385', 'NA19334', 'NA19448', 'NA19372', 'NA19467', 'NA19310', 'NA19355', 'NA19346', 'NA19371', 'NA19473', 'NA19390', 'NA19378', 'NA19457', 'NA19443', 'NA19347', 'NA19026', 'NA19430', 'NA19019', 'NA19451', 'NA19321', 'NA19331', 'NA19455', 'NA19384', 'NA19439', 'NA19350', 'NA19438', 'NA19394', 'NA19316', 'NA19436', 'NA19332', 'NA19314', 'NA19323', 'NA19037', 'NA19429', 'NA19391', 'NA19456', 'NA19471', 'NA19020', 'NA19318', 'NA19466', 'NA19030', 'NA19031', 'NA19317', 'NA19309', 'NA19308', 'NA19374', 'NA19445', 'NA19041', 'NA19393', 'NA19463', 'NA19437', 'NA19398', 'NA19376', 'NA19395', 'NA19379', 'NA19403', 'NA19312', 'NA19035', 'NA19027', 'NA19380', 'NA19036', 'NA19404', 'NA19359'],
    "MSL": ['HG03547', 'HG03380', 'HG03058', 'HG03451', 'HG03398', 'HG03572', 'HG03478', 'HG03419', 'HG03557', 'HG03462', 'HG03078', 'HG03394', 'HG03452', 'HG03052', 'HG03091', 'HG03549', 'HG03057', 'HG03073', 'HG03079', 'HG03567', 'HG03066', 'HG03476', 'HG03458', 'HG03063', 'HG03212', 'HG03082', 'HG03069', 'HG03391', 'HG03432', 'HG03393', 'HG03224', 'HG03209', 'HG03439', 'HG03060', 'HG03442', 'HG03401', 'HG03473', 'HG03225', 'HG03382', 'HG03096', 'HG03479', 'HG03558', 'HG03385', 'HG03575', 'HG03565', 'HG03559', 'HG03072', 'HG03571', 'HG03081', 'HG03472', 'HG03445', 'HG03485', 'HG03397', 'HG03577', 'HG03388', 'HG03548', 'HG03055', 'HG03578', 'HG03378', 'HG03097', 'HG03376', 'HG03428', 'HG03064', 'HG03436', 'HG03086', 'HG03061', 'HG03470', 'HG03074', 'HG03095', 'HG03077', 'HG03449', 'HG03455', 'HG03563', 'HG03437', 'HG03464', 'HG03410', 'HG03433', 'HG03461', 'HG03484', 'HG03457', 'HG03088', 'HG03583', 'HG03054', 'HG03084', 'HG03431', 'HG03460', 'HG03085', 'HG03556', 'HG03469', 'HG03446'],
    "MXL": ['NA19717', 'NA19676', 'NA19649', 'NA19722', 'NA19648', 'NA19764', 'NA19752', 'NA19780', 'NA19756', 'NA19734', 'NA19658', 'NA19762', 'NA19723', 'NA19789', 'NA19774', 'NA19682', 'NA19741', 'NA19670', 'NA19776', 'NA19651', 'NA19654', 'NA19792', 'NA19794', 'NA19782', 'NA19788', 'NA19669', 'NA19664', 'NA19679', 'NA19759', 'NA19720', 'NA19783', 'NA19725', 'NA19795', 'NA19777', 'NA19761', 'NA19749', 'NA19729', 'NA19728', 'NA19740', 'NA19735', 'NA19758', 'NA19770', 'NA19747', 'NA19750', 'NA19771', 'NA19755', 'NA19731', 'NA19655', 'NA19779', 'NA19726', 'NA19678', 'NA19652', 'NA19719', 'NA19773', 'NA19684', 'NA19657', 'NA19663', 'NA19716', 'NA19786', 'NA19746', 'NA19785', 'NA19681', 'NA19732'],
    "PEL": ['HG01920', 'HG02003', 'HG02008', 'HG02271', 'HG01973', 'HG02278', 'HG01917', 'HG01997', 'HG01892', 'HG01982', 'HG01979', 'HG01991', 'HG02262', 'HG01950', 'HG02286', 'HG01980', 'HG01948', 'HG01926', 'HG01961', 'HG02277', 'HG02266', 'HG01941', 'HG02002', 'HG01967', 'HG02252', 'HG02272', 'HG01578', 'HG02285', 'HG02260', 'HG02348', 'HG01992', 'HG01951', 'HG02090', 'HG01971', 'HG02292', 'HG01932', 'HG01935', 'HG02425', 'HG02006', 'HG01954', 'HG02253', 'HG02147', 'HG01974', 'HG02259', 'HG01965', 'HG02345', 'HG01924', 'HG01572', 'HG01942', 'HG01927', 'HG02298', 'HG01947', 'HG02274', 'HG01970', 'HG02291', 'HG01944', 'HG01953', 'HG02275', 'HG01939', 'HG01923', 'HG01918', 'HG01571', 'HG01566', 'HG01945', 'HG02104', 'HG01977', 'HG02105', 'HG01968', 'HG01893', 'HG02146', 'HG02089', 'HG02312', 'HG01577', 'HG02150', 'HG02304', 'HG01921', 'HG02299', 'HG02265', 'HG02301', 'HG01976', 'HG01565', 'HG01936', 'HG01938', 'HG01933', 'HG02102'],
    "PJL": ['HG03238', 'HG02601', 'HG03237', 'HG03624', 'HG03229', 'HG03660', 'HG03631', 'HG02648', 'HG02731', 'HG01583', 'HG02737', 'HG03019', 'HG02603', 'HG02685', 'HG02682', 'HG02727', 'HG02784', 'HG02775', 'HG02604', 'HG02490', 'HG02700', 'HG03021', 'HG02790', 'HG02649', 'HG02783', 'HG03767', 'HG01589', 'HG02696', 'HG02597', 'HG03634', 'HG02657', 'HG03708', 'HG02733', 'HG02697', 'HG02789', 'HG03640', 'HG02793', 'HG02688', 'HG03016', 'HG02787', 'HG03488', 'HG03663', 'HG02652', 'HG02661', 'HG03619', 'HG02684', 'HG03228', 'HG03652', 'HG01593', 'HG03653', 'HG03636', 'HG02691', 'HG03667', 'HG03649', 'HG03235', 'HG02694', 'HG03705', 'HG03702', 'HG02778', 'HG02600', 'HG02493', 'HG02724', 'HG02681', 'HG02725', 'HG02734', 'HG03625', 'HG02491', 'HG03022', 'HG02699', 'HG02658', 'HG03490', 'HG03491', 'HG01586', 'HG02654', 'HG03629', 'HG02736', 'HG03234', 'HG02690', 'HG02494', 'HG02786', 'HG03668', 'HG03709', 'HG03706', 'HG03765', 'HG02792', 'HG02774', 'HG03015', 'HG02655', 'HG02660', 'HG02651', 'HG03762', 'HG03703', 'HG02687', 'HG02728', 'HG03018', 'HG02780'],
    "PUR": ['HG01248', 'HG01052', 'HG01079', 'HG00732', 'HG00731', 'HG00641', 'HG01413', 'HG01176', 'HG00551', 'HG01286', 'HG01083', 'HG01064', 'HG01171', 'HG01047', 'HG01325', 'HG00553', 'HG01412', 'HG01067', 'HG01101', 'HG01111', 'HG01077', 'HG01402', 'HG01167', 'HG01104', 'HG01188', 'HG00734', 'HG01308', 'HG01405', 'HG01105', 'HG01168', 'HG01075', 'HG00637', 'HG01326', 'HG00740', 'HG01089', 'HG01182', 'HG01396', 'HG01303', 'HG01061', 'HG01073', 'HG01204', 'HG01205', 'HG01094', 'HG01082', 'HG01058', 'HG01170', 'HG01110', 'HG01414', 'HG01398', 'HG01080', 'HG00737', 'HG01177', 'HG01187', 'HG01174', 'HG01060', 'HG01088', 'HG01108', 'HG01072', 'HG01247', 'HG01393', 'HG01183', 'HG01323', 'HG01242', 'HG01162', 'HG00736', 'HG01055', 'HG01302', 'HG01173', 'HG01241', 'HG01097', 'HG01161', 'HG00743', 'HG01392', 'HG01085', 'HG01049', 'HG01197', 'HG00742', 'HG01054', 'HG01048', 'HG01198', 'HG01305', 'HG01395', 'HG01403', 'HG01070', 'HG01190', 'HG01164', 'HG01311', 'HG01107', 'HG00638', 'HG00554', 'HG00640', 'HG01098', 'HG01063', 'HG01066', 'HG01312', 'HG01200', 'HG01069', 'HG01051', 'HG01191', 'HG01102', 'HG00739', 'HG01095', 'HG01092', 'HG01086'],
    "STU": ['HG03696', 'HG03711', 'HG03844', 'HG03999', 'HG03673', 'HG03691', 'HG03697', 'HG04039', 'HG03897', 'HG03885', 'HG03698', 'HG03850', 'HG03756', 'HG04006', 'HG03894', 'HG03900', 'HG04075', 'HG04038', 'HG03689', 'HG03851', 'HG04035', 'HG03750', 'HG03990', 'HG03684', 'HG03740', 'HG03687', 'HG03757', 'HG03899', 'HG03945', 'HG03755', 'HG03642', 'HG03733', 'HG03672', 'HG03848', 'HG03738', 'HG03896', 'HG04029', 'HG03643', 'HG03760', 'HG03741', 'HG03836', 'HG03886', 'HG03679', 'HG03681', 'HG03645', 'HG04047', 'HG03753', 'HG03752', 'HG04099', 'HG03694', 'HG03646', 'HG03951', 'HG03884', 'HG03953', 'HG03754', 'HG03644', 'HG03985', 'HG03849', 'HG03949', 'HG03895', 'HG04003', 'HG03989', 'HG03838', 'HG03854', 'HG03858', 'HG03745', 'HG03947', 'HG03743', 'HG03943', 'HG03890', 'HG04229', 'HG04210', 'HG03898', 'HG04106', 'HG03944', 'HG04227', 'HG03837', 'HG03680', 'HG03857', 'HG04100', 'HG04042', 'HG03888', 'HG03856', 'HG03887', 'HG03693', 'HG03744', 'HG03995', 'HG03955', 'HG03685', 'HG03986', 'HG03692', 'HG03746', 'HG03686', 'HG03695', 'HG03950', 'HG03690', 'HG04107', 'HG03998', 'HG04033', 'HG03736', 'HG03846', 'HG03991'], 
    "TSI": ['NA20768', 'NA20582', 'NA20816', 'NA20814', 'NA20806', 'NA20796', 'NA20811', 'NA20510', 'NA20798', 'NA20540', 'NA20581', 'NA20753', 'NA20517', 'NA20787', 'NA20762', 'NA20521', 'NA20505', 'NA20831', 'NA20515', 'NA20534', 'NA20773', 'NA20503', 'NA20514', 'NA20532', 'NA20828', 'NA20512', 'NA20801', 'NA20827', 'NA20770', 'NA20805', 'NA20821', 'NA20774', 'NA20758', 'NA20799', 'NA20541', 'NA20756', 'NA20588', 'NA20809', 'NA20542', 'NA20544', 'NA20520', 'NA20763', 'NA20513', 'NA20509', 'NA20516', 'NA20535', 'NA20766', 'NA20778', 'NA20807', 'NA20539', 'NA20528', 'NA20790', 'NA20533', 'NA20538', 'NA20765', 'NA20529', 'NA20537', 'NA20819', 'NA20536', 'NA20795', 'NA20818', 'NA20803', 'NA20527', 'NA20772', 'NA20585', 'NA20589', 'NA20531', 'NA20760', 'NA20800', 'NA20587', 'NA20769', 'NA20524', 'NA20530', 'NA20759', 'NA20826', 'NA20504', 'NA20757', 'NA20764', 'NA20586', 'NA20752', 'NA20802', 'NA20785', 'NA20783', 'NA20786', 'NA20543', 'NA20810', 'NA20755', 'NA20812', 'NA20522', 'NA20832', 'NA20507', 'NA20519', 'NA20771', 'NA20761', 'NA20808', 'NA20792', 'NA20754', 'NA20813', 'NA20518', 'NA20815', 'NA20767', 'NA20525', 'NA20775', 'NA20804', 'NA20797', 'NA20502', 'NA20506', 'NA20822'],
    "YRI": ['NA19238', 'NA18868', 'NA19206', 'NA19248', 'NA19143', 'NA18508', 'NA19225', 'NA18489', 'NA18502', 'NA19152', 'NA19209', 'NA19102', 'NA19171', 'NA19107', 'NA18916', 'NA18907', 'NA18499', 'NA19201', 'NA18856', 'NA19095', 'NA19189', 'NA19093', 'NA19108', 'NA19141', 'NA18873', 'NA18934', 'NA18923', 'NA19213', 'NA19138', 'NA19223', 'NA19236', 'NA18520', 'NA18486', 'NA18858', 'NA18488', 'NA18917', 'NA18924', 'NA18867', 'NA18501', 'NA19116', 'NA18511', 'NA18504', 'NA19131', 'NA18933', 'NA19118', 'NA18522', 'NA19184', 'NA19130', 'NA19197', 'NA19210', 'NA18871', 'NA19185', 'NA18507', 'NA18910', 'NA19096', 'NA18861', 'NA19117', 'NA19239', 'NA19146', 'NA18915', 'NA18505', 'NA18874', 'NA19149', 'NA18510', 'NA19160', 'NA19098', 'NA19222', 'NA19119', 'NA19172', 'NA19159', 'NA19257', 'NA19153', 'NA19247', 'NA18877', 'NA18881', 'NA19121', 'NA19190', 'NA19204', 'NA19200', 'NA18870', 'NA19099', 'NA18519', 'NA19114', 'NA19137', 'NA19198', 'NA19144', 'NA19147', 'NA19129', 'NA19175', 'NA18853', 'NA18517', 'NA19214', 'NA19256', 'NA18523', 'NA19113', 'NA19235', 'NA19092', 'NA18909', 'NA18912', 'NA18908', 'NA18516', 'NA19207']

}

def compute_t_test(mdf,population_name_1 = "GBR",population_name_2 = "ASW"):
     t_statistic, p_value = stats.ttest_ind(mdf[population_name_1], mdf[population_name_2], equal_var=True)
     print(f"\nTwo-Sample Independent T-Test for {population_name_1} and {population_name_2}:")
     print(f"T-statistic: {t_statistic:.4f}")
     print(f"P-value: {p_value:.4f}")


def genome_variant_mean (df,genome_ids):
     df = df[["gene"]+ genome_ids ]
     genome_df = df.groupby(["gene"]).sum().sum() / len(genome_ids)
     rdf = pd.DataFrame()
     rdf['mean']
     return genome_df

# def create_mean_variant_counts_for_populations(root_dir, genomes: Dict, outputfile: str = None):
#     df_list = []
#     for population_name, genome_ids in genomes.items():
#         infile = join(root_dir, f"populations/output/{population_name}/all.csv")
#         df = pd.read_csv(infile)
#         df = df[["gene"] + genome_ids]
#         genome_df = df.groupby(["gene"]).sum().sum() / len(genome_ids)
#         population_df = pd.DataFrame({'mean': genome_df})
#         population_df.rename(columns={'mean': population_name}, inplace=True)
#         df_list.append(population_df)
#     combined_df = pd.concat(df_list, axis=1)
#     if outputfile:
#         combined_df.to_csv(outputfile)
    
#     return combined_df



def mean_variant_count(df,genome_ids):
    df = df[["gene"]+ genome_ids ]
    g_df = df.groupby(["gene"]).sum().sum(axis=1)
    g_df = g_df /len(genome_ids)
    rdf= pd.DataFrame()
    rdf['mean']= g_df / len(genome_ids)
    return rdf

def total_variant_count(df,genome_ids):
    df = df[["gene"]+ genome_ids ]
    g_df = df.groupby(["gene"]).sum().sum(axis=1)
    rdf= pd.DataFrame()
    rdf['count']= g_df 
    return rdf

def create_gnome_mean_df(root_dir,genomes:Dict,outputfile:str=None):
    df_list = list()
    for population_name in genomes:
        infile = join(root_dir,f"populations/output/{population_name}/all.csv")
        idf = pd.read_csv(infile)
        odf = mean_variant_count(df=idf,genome_ids = genomes[population_name])
        odf.rename(columns={'mean':population_name},inplace=True)
        df_list.append(odf)
    mdf = pd.concat(df_list,axis=1)
    if outputfile:
        mdf.to_csv(outputfile)

    return mdf

def create_gnome_count_df(root_dir,genomes:Dict,outputfile:str=None):
    df_list = list()
    for population_name in genomes:
        infile = join(root_dir,f"populations/output/{population_name}/all.csv")
        idf = pd.read_csv(infile)
        odf = total_variant_count(df=idf,genome_ids = genomes[population_name])
        odf.rename(columns={'count':population_name},inplace=True)
        df_list.append(odf)
    mdf = pd.concat(df_list,axis=1)
    if outputfile:
        mdf.to_csv(outputfile)

    return mdf

if __name__ == "__main__":
    root_dir = join(Path.home(),"cp_als")
    # df_list = list()
    # population_name = "FIN"
    # infile = join(root_dir,f"populations/output/{population_name}/all.csv")
    # idf = pd.read_csv(infile)
    # odf = mean_variant_count(df=idf,genome_ids = genomes[population_name])
    # odf.rename(columns={'mean':population_name},inplace=True)
    # df_list.append(odf)

    # population_name = "KHV"
    # infile = join(root_dir,f"populations/output/{population_name}/all.csv")
    # idf = pd.read_csv(infile)
    # odf = mean_variant_count(df=idf,genome_ids = genomes[population_name])
    # odf.rename(columns={'mean':population_name},inplace=True)
    # df_list.append(odf)
    # mdf = pd.concat(df_list,axis=1)

    mdf1 = create_gnome_mean_df(root_dir=root_dir,genomes=genomes)
    pass
